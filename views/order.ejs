<html lang="en">
<head>
    <%- include('./partials/head.ejs') %>
    <script src="/scripts/orderPageFunctions.js"></script>
</head>
<body>
<%- include('./partials/darkModeContainer.ejs') %>
    <%- include('./partials/nav.ejs') %> 

    <% 
        let keyIDs = {} 

        function GenerateUniqueID() {
            return Math.floor(Math.random() * Date.now())
        }
    %> 

    <main>
        <div class="productsRoot">
            <% for([kindsKey, kinds] of Object.entries(products)) { 
                kindsUID = GenerateUniqueID();
            %> 
                
                <div class="productKinds" id="<%- kindsKey %>Button">
                    <button onclick="ToggleElement('<%- kindsUID %>')"><%- kindsKey %> </button>
                    <div class="productPatterns" id="<%- kindsUID %>" style="display: none;">
                        <% for([patternsKey, patterns] of Object.entries(kinds)) { 
                            patternsUID = GenerateUniqueID();
                        %>

                            <button onclick="ToggleElement('<%- patternsUID %>')"><%- patternsKey %> </button>
                            <div class="products" id="<%- patternsUID %>" style="display: none;">
                                <% for([productKey, product] of Object.entries(patterns)) { 
                                    productUID = GenerateUniqueID();
                                %>

                                    <div class="productContainer" id="<%- productUID %>">
                                        <h3><%- product.title %> </h3>
                                        <h4><%- product.description %> </h4>
                                        <img src="<%- product.images[0] %>">
                                        <input id="<%- productUID %>Slider" type="range" min="10" max="30" step="0.5" 
                                            oninput="ShowPriceEstimate(this.value, '<%- productUID %>', '<%- product.estimatedPriceKr %>')" 
                                            onchange="ShowPriceEstimate(this.value, '<%- productUID %>', '<%- product.estimatedPriceKr %>')"
                                            value="20">
                                        <p class="lengthDisplay" id="<%- productUID %>lengthDisplay">-cm</p>
                                        <p class="priceEstimate" >Estimated price: <span id="<%- productUID %>PriceEstimate">-</span>kr</p>
                                        <p class="priceExplained"><%- product.estimatedPriceKr %>kr per cm plus a base price of [...]</p>
                                        <script>ShowPriceEstimate(document.getElementById('<%- productUID %>'+'Slider').value, '<%- productUID %>', '<%- product.estimatedPriceKr %>')</script>
                                        <button onclick="">Buy</button>
                                    </div>
                                <% } %>
                            </div>
                        <% } %>
                    </div>
                </div>
            <% } %> 
        </div>
    </main>
</div>
</body>
</html>